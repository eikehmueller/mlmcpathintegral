\documentclass[11pt]{article}
\usepackage[cm]{fullpage}
\usepackage{amsmath,amssymb}
\usepackage{graphicx}
\usepackage{color}
\usepackage{algorithm}
\usepackage{algcompatible}
\usepackage[relative,overlay]{textpos}
\usepackage[colorlinks,bookmarksopen,bookmarksnumbered,citecolor=red,urlcolor=red,breaklinks=true]{hyperref}
\newcommand{\cblue}[1]{{\color{blue}#1}}
\renewcommand{\vec}[1]{{#1}}
\newcommand{\figdir}{./figures/}
\newcommand{\note}[1]{\cblue{NOTE: #1}}
\author{Eike Mueller, University of Bath}
\date{\today}
\title{Multilevel Monte Carlo for Quantum Field Theories on the Lattice}
\begin{document}
\maketitle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Motivation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
By using Feynman's path integral formulation of quantum mechanics \cite{Feynman2010}, lattice field theories predict the fundamental interactions of subatomic particles. Numerical results are obtained by Markov Chain Monte Carlo (MCMC) sampling of discretised fields on a space-time grid. To produce physically relevant results, both the number of lattice points and the number of Monte Carlo samples have to be increased, making accurate simulations prohibitively expensive. In similar contexts the Multilevel Monte Carlo (MLMC) algorithm \cite{Giles2015} has been shown to lead to a considerable reduction in computational complexity. The key idea is the construction of a set of coarse grained theories which accelerate sampling without introducing any additional bias errors. It should be stressed that MLMC is a proper variance reduction technique and goes beyond hierarchical samplers such as \cite{Faas1986}.
Recently the multilevel approach has been adapted to an MCMC setting in \cite{Dodwell2015}. We aim to apply the same methods in the context of lattice field theory, exploiting the natural hierarchy of coarse grained effectve theories obtained by renormalisation. In contrast to the Standard Monte Carlo (StMC) method, the computational complexity of MLMC is independent of the space-time dimension $d$. This makes the approach particularly promising for larger $d$, such as five-dimensional domain-wall fermion formulations \cite{Kaplan1992} of QCD. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methods}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Lattice Field Theory}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Let $\theta=\theta(x)$ be a scalar quantum field which is defined at any point $x$ in a $d$-dimensional unit box. The expectation value $\langle Q\rangle$ of an observable (or ``quantity of interest'') $Q$ can be written as a sum over all possible field configurations $\theta$ weighted by the exponential of the action $S[\theta]$ (with normalisation factor $Z$):
\begin{equation}
  \langle Q\rangle = Z^{-1} \int_{\text{all $\theta$}} Q[\theta]e^{-S[\theta]} \approx \frac{1}{N} \sum_{n=1}^N Q[\theta_L^n] = \hat{Q}^{\text{StMC}}_{L,N} \qquad \mathbb{R}^{M}\ni \theta_L^n\sim e^{-S[\cdot]}\label{eqn:StMCestimator}
\end{equation}
In Eq. (\ref{eqn:StMCestimator}) two approximations are made to obtain an estimator $\hat{Q}^{\text{StMC}}_{L,N}$ for $\langle Q\rangle$:
\begin{itemize}
    \item \textbf{Discretisation}. The field $\theta$ is represented by its values $(\theta_L)_j$ at the $j=1,\dots,M=2^{L\cdot d}$ points of a $d$-dimensional space-time lattice with grid $a=2^{-L}$. The resulting bias error is $\mathcal{O}(a^\alpha)=\mathcal{O}(M^{-\alpha/d})$.
    \item \textbf{Stochastic integration}. The integral is evaluated by summing the value of the observables for $N$ random fields $\{\theta_L^n\}_{n=1}^N$ which are distributed according to $e^{-S[\cdot ]}$. The sampling error is $\propto{1/\sqrt{N}}$.
\end{itemize}
Sophisticated methods such as Hybrid Monte Carlo to reduce autocorrelation \cite{Duane1987} and improved actions to increase the discretisation order $\alpha$ \cite{Lepage1994} have been developed to minimise both errore.
The computational cost to calculate $\langle Q\rangle$ to accuracy $\epsilon$ is $\text{C}^{\text{StMC}}\propto N\cdot M=\mathcal{O}(\epsilon^{-2-d/\alpha})$. As we will argue now, multilevel Monte Carlo has the potential to reduce this to $\mathcal{O}(\epsilon^{-2}|\log(\epsilon)|)$ \cite{Dodwell2015}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Multilevel Monte Carlo}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The key idea in Multilevel Monte Carlo is to construct a set of approximate models for fields $\theta_\ell$ and $\Theta_\ell$ on levels $\ell=L-1,\dots,0$ which are defined on coarser lattices (see Fig. \ref{fig:multilevel}, left).
\begin{figure}
  \begin{center}
  \begin{minipage}{0.55\linewidth}
    \includegraphics[width=\linewidth]{\figdir/multilevel_schematic.pdf}
  \end{minipage}
  \hfill
  \begin{minipage}{0.4\linewidth}
    \includegraphics[width=\linewidth]{\figdir/multilevel_paths.pdf}
  \end{minipage}
  \caption{Multilevel hierarchy of grids (left) and hierarchical sampling of paths (right)}\label{fig:multilevel}
  \end{center}
\end{figure}
By calculating differences in the observables between subsequent levels the following estimator can be written down
\begin{equation}
  \hat{Q}_{L,\{N_\ell\}}^{\text{MLMC}} := \hat{Q}_{0,N_0}^{\text{StMC}} + \sum_{\ell=1}^L \hat{Y}_{\ell,N_\ell}^{\text{MC}}\qquad\text{with}\quad
  \hat{Y}_{\ell,N_\ell}^{\text{MC}} := \frac{1}{N_\ell}\sum_{n=1}^{N_\ell} \hat{Y}_\ell^n = \frac{1}{N_\ell}\sum_{n=1}^{N_\ell} \left(Q_\ell[\theta_\ell^n] - Q_{\ell-1}[\Theta_{\ell-1}^n]\right)\label{eqn:MLMCestimator}
\end{equation}
It is important to note that by construction as a telescoping sum the bias of the multilevel estimator $\hat{Q}_{L,\{N_\ell\}}$ in Eq. (\ref{eqn:StMCestimator}) is the same as the estimator in Eq. (\ref{eqn:MLMCestimator}). By choosing the number of samples $N_\ell$ on each level appropriately, the cost is greatly reduced for two reasons:
\begin{enumerate}
\item \textbf{Variance decay.} On the difference $Y_\ell$ of the observable on two subsequent levels is estimate, this difference has a much smaller variance than the observable itself and requires much less Monte Carlo samples. 
  \item \textbf{Reduced coarse level cost.} Since the number of lattice sites on coarse levels is much smaller, especially in high dimensions, sampling on those levels is significantly cheaper.
\end{enumerate}
As shown in the Complexity Theorem in \cite{Dodwell2015}, the computational cost of the multilevel MCMC method can be reduced to up to $C^{\text{MCMC}}=\mathcal{O}(\epsilon^{-2}|\log(\epsilon)|)$ the variance decays as $\text{Var}[Y_\ell]\propto M_\ell^{-\beta}$. This requires requires suitable coupling between the Markov chains $\theta_\ell^n$ and $\Theta_{\ell-1}^n$ on subsequent levels; a suitable algorithm for this is described in \cite{Dodwell2015}. We have implemented this algorithm for a simple one-dimensional quantum system with quartic potential $V$ (compare \cite{Creutz1981}). In this case the action on level $\ell$ with lattice spacing $a_\ell=2^{L-\ell}a\gg a$ and $M_\ell=2^{\ell-L}M\ll M$ time slices is
\begin{equation}
  S\left[\theta_\ell\right] = \sum_{j=1}^{M_\ell} \left\{\frac{m_0}{2a_\ell}\left((\theta_\ell)_j-(\theta_\ell)_{j-1}\right)^2 + a_\ell V\left((\theta_\ell)_j\right)\right\}\qquad V(\theta) = \frac{1}{2}m_0\mu^2\theta^2+\frac{1}{4}\lambda^2\theta^4.\label{eqn:quantum_action}
\end{equation}
As Fig. \ref{fig:multilevel} (right) illustrates, the fine level trial state $\theta'_\ell=[\theta'_{\ell,C},\theta'_{\ell,F}]$ is constructed by taking the values $\theta'_{\ell,C}$ at the even nodes from the coarse level path $\Theta_\ell^{n+1}$. The odd modes $\theta'_{\ell,F}$ are drawn from a free particle action $q_{\ell}^{\text{MF}}$ conditioned on the coarse modes. A subsequent Metropolis accept/reject with the fine level action state ensures that the next state $\theta_\ell^n$ in the fine level Markov chain is drawn from the correct distribution; this guarantees the telescoping-sum property and avoids additional bias.

As Fig. \ref{eqn:quantum_results} confirms, the variance of the differences $Y_\ell$ decays $\propto M_\ell^{-1}$ and is much smaller than the variance of the observable itself both for the harmonic oscillator ($\mu=1$, $\lambda=0$) and for a double-well potential ($\mu=-1$, $\lambda=1$). In the latter case the coarse modes $\Theta_{\ell-1}$ as sampled using hybrid Monte Carlo \cite{Duane1987}.
\begin{figure}
  \begin{center}
  \begin{minipage}{0.45\linewidth}
    \includegraphics[width=\linewidth]{\figdir/variance_decay_harmonic.pdf}
    \begin{textblock}{4.0}(1.25,-1.0)
      $V(\theta)=\frac{1}{2}\theta^2$
    \end{textblock}
    \begin{textblock}{4.0}(4.25,-2.75)
      \includegraphics[width=0.4\linewidth]{\figdir/potential_harmonic.pdf}
    \end{textblock}
  \end{minipage}
  \hfill
  \begin{minipage}{0.45\linewidth}
    \includegraphics[width=\linewidth]{\figdir/variance_decay_quartic.pdf}
    \begin{textblock}{4.0}(1.25,-1.0)
      $V(\theta)=-\frac{1}{2}\theta^2+\frac{1}{4}\theta^4$
    \end{textblock}
    \begin{textblock}{4.0}(4.25,-2.4)
      \includegraphics[width=0.4\linewidth]{\figdir/potential_quartic.pdf}
    \end{textblock}
  \end{minipage}
  \caption{Variance decay of difference estimator $Y_\ell$ between subsequent levels $\ell$ for the harmonic oscillator (left) and quartic double-well potential (right). The variance of the observable itself is shown as a dashed line at the top.}
  \label{eqn:quantum_results}
  \end{center}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Effective Field Theories and renormalisation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
To guarantee optimal coupling between subsequent levels and hence reduce the variance $Y_\ell$ requires that the theories on the subsequent levels are ``similar''; in other words, the theory on level $\ell-1$ should describe the same physics as the coarse, low energy modes on level $\ell$. This is the concept of an effective theory, i.e. the theory on level $\ell$ is obtained by integrating out the quantum fluctuations of fine modes on level $\ell$. For some cases (harmonic oscillator or free quantum field) this can be done exactly. In other cases it is possible to achieve it approximately by neglecting irrelevant operators. In this case the parameters of the coarse level theory (e.g. $m_0$, $\mu$ and $\lambda$ in Eq. (\ref{eqn:quantum_action})) can be obtained by the renomalisation group transformation from scales $a_\ell$ to $a_{\ell-1}$. Due to the great practical relevance of Quantum Chromodynamics (QCD), asymptotically free theories are of particular interest. In this case it is possible to use perturbation theory. Other cases of interest are theories close to a non-trivial critical point where the parameters are scale invariant, but Markov chain Monte Carlo sampling is very challenging due to long range correlations.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Workplan}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Ultimately the goal will be to apply Multilevel Monte Carlo techniques to lattice QCD. However, since this theory is non-trial (the field is not a scalar and the action is invariant under local gauge transformation, which means that the probability density is constant on submanifolds), we will apply the methods to models of increasing complexity:
\begin{enumerate}
\item Study one-dimensional quantum system and extend the results in Fig. \ref{eqn:quantum_results} to construct a multilevel MCMC sampler in those cases. While important to sketch out the general methods, MLMC is likely to achieve gains mainly for small $\epsilon$ since $d=1$ and we only expect at gain of $\epsilon^{-1/\alpha}/|\log(\epsilon)|$ (for example, as the calculation in the appendix of \cite{Creutz1981} shows, $\alpha=2$ for the harmonic oscillator).
\item Extend this to higher-dimensional systems such as the (exacly renormalisable) free field in $d$-dimensions or the asymptotically free non-linear sigma model. Since the cost of the standard Monte Carlo method grows $\propto \epsilon^{-2-d/\alpha}$ this will give more relatistic estimates of achievable gains.
\item Investigate the application in lattice QCD. One particular challenge here is ensuring that coupling between subsequent levels does not break gauge invariance.
\end{enumerate}
\bibliographystyle{unsrt}
{\footnotesize
  \bibliography{plan}
}
\end{document}
